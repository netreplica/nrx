name: ate
topology:
    nodes:
        otg:
            kind: linux
            image: ghcr.io/open-traffic-generator/keng-controller:latest
            cmd: --accept-eula --http-port 8443
            ports:
                - 8443:8443
        ate1:
            kind: linux
            image: ghcr.io/open-traffic-generator/ixia-c-traffic-engine:latest
            env:
              OPT_LISTEN_PORT: 5555
              ARG_IFACE_LIST:  virtual@af_packet,eth1 virtual@af_packet,eth2
              OPT_NO_HUGEPAGES: Yes
              OPT_NO_PINNING: Yes
              WAIT_FOR_IFACE: Yes
            labels:
                graph-icon: ate
                graph-level: 10
                role: ATE
                group: ate
                platform: Keysight Ixia-c
                vendor: Keysight
                model: Ixia-c Test Node
        ate1-pe:
            kind: linux
            image: ghcr.io/open-traffic-generator/ixia-c-protocol-engine:latest
            network-mode: container:ate1
            startup-delay: 5
            env:
              INTF_LIST: eth1,eth2,
            labels:
                graph-icon: ate
                graph-level: 10
                role: ATE
                group: ate
                platform: Keysight Ixia-c
                vendor: Keysight
                model: Ixia-c Test Node
                graph-hide: yes

        ate2:
            kind: linux
            image: ghcr.io/open-traffic-generator/ixia-c-traffic-engine:latest
            env:
              OPT_LISTEN_PORT: 5555
              ARG_IFACE_LIST:  virtual@af_packet,eth1 virtual@af_packet,eth2
              OPT_NO_HUGEPAGES: Yes
              OPT_NO_PINNING: Yes
              WAIT_FOR_IFACE: Yes
            labels:
                graph-icon: ate
                graph-level: 10
                role: ATE
                group: ate
                platform: Keysight Ixia-c
                vendor: Keysight
                model: Ixia-c Test Node
        ate2-pe:
            kind: linux
            image: ghcr.io/open-traffic-generator/ixia-c-protocol-engine:latest
            network-mode: container:ate2
            startup-delay: 5
            env:
              INTF_LIST: eth1,eth2,
            labels:
                graph-icon: ate
                graph-level: 10
                role: ATE
                group: ate
                platform: Keysight Ixia-c
                vendor: Keysight
                model: Ixia-c Test Node
                graph-hide: yes

    links:
        - endpoints: ["ate1:eth1", "ate2:eth1"]
        - endpoints: ["ate1:eth2", "ate2:eth2"]
